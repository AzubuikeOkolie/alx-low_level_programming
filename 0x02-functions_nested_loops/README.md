This is c-functions and nested loop
